# Welcome to my final project's README

# Description
For my final project, I decided to implement a movie theater web application. This web application has the purpose of acting like a local theater's website in which users can log in to make reservations for available films. It implements features to view all available films, view a film's description and rating, search a film by title, director or main cast, and make a reservation or cancel a reservation of a determined amount of seats for a specific film. 

There are two types of users that can log into my web appplication: admins and consumers. Admins have the ability to create a new film for the theater, to allow consumers to make reservations on that new film. Additionally, they have the ability to cancel reservations for any given consumer. On the other hand, consumers can only make reservations and can cancel *only their own* reservations. Once a reservation is made, the consumer is presented with a random reservation id they can then present at the theater.  

You can think of the admin user as the owner of the theater, that has control over what films to offer to the consumers/customers, and the reserved seats, and you can think of the consumer user as a client that intends to make a reservation to go to the theater. 

You'll find the requirements that I set for my project, which are also shown on my 5-minute demo of the app (available [here](https://youtu.be/wYEL4SQRQIs)) below:

- Users
    - Have an 'admin' user and a 'consumer' user.
    - Admins have the ability to add new films to the 'Now playing' page.
    - Admins have the ability to cancel any reservation.
    - Consumers only have the ability to make reservations and cancel their own reservations.
- New film
    - Only admins can create a new film.
    - Render a form to enter the film's title when an admin user clicks on the 'New film' button in the navbar.
    - Submit it and redirect to the 'Now playing' page.
- Now playing
    - 'Now playing' page where all films available in the theater are shown.
    - Render film title, poster, director, year, genre, main cast, overall IMDB rating (from external API) and amount of reserved/available seats.
- Film page
    - Render a film page with all the film's attributes.
    - Allow consumer users to click on a 'make reservation' button that calls a reservation function.
    - Render a div that shows reserved seats amount and available seats amount.
- Reservation page
    - When the user clicks on the reservation button, redirect them to a view of the theater with the screen and an array of divs that represents the seats.
    - Set a fixed amount of seats for the theater.
    - Reserved/occupied seats shaded in white.
    - Each seat marked with a letter-number code (ex: A4).
    - Shade the selected seats in blue.
    - If the user selects available seats and clicks on the reserve button, announce successful reservation and provide a reservation number via a dismissible message.
    - Don't allow the user to select already taken seats.
    - If all seats are taken for a particular film, don't allow reservations.
- User reservations page
    - When the user clicks on their name at the top of the navbar, redirect them to a page where they can see all their currently confirmed reservations.
    - Render all of that reservations' attributes.
    - Include button that allows them to cancel that specific reservation. 
- Search for movie
    - Display a search bar that allows to search films by title, director or main cast.
    - Render results in a "results" page matching the user's query.

# What's contained in each file
Please keep in mind that the base directory of this project is found at ```https://github.com/me50/jpnaranjo20/blob/web50/projects/2020/x/capstone/```. Each of the files that are described below have this base directory, but for the purposes of keeping a clean look on this document, I will only write the part of the directory that goes after the base one.

## finalproject/settings.py
This file contains all of the settings needed to run my application. It was autogenerated when I created the Django project.

## finalproject/urls.py
This file contains the base url patterns that my web application accesses. It includes the admin site and the urls described in the ```theater/urls.py``` found inside of the main application, which I called 'theater'. This file was also autogenerated by Django. The other files found inside of ```finalproject``` were autogenerated and I did not modify them.

## theater/static/theater/index.js
This JavaScript file is the base JavaScript document that manipulates the front-end of my application. It includes all of the functions I created to get the front-end working, and each function is appropriately commented so as to provide you with a good understanding of each function.

## theater/static/theater/styles.css
This CSS file manipulates the styling of my web application. Although I also used the Bootstrap stylesheet, this file contains all of the personal styling I wanted to give to my application. 

## theater/templates/theater/film.html
This HTML template is the page that renders when a user clicks on a specific film to view all of that film's attributes in a single page. It also includes a 'make/view reservations' button (depending on the admin status of the user).

## theater/templates/theater/index.html
This HTML template is the main and default page of my application. It renders a view of all of the films that are currently playing in the theater, with some of the film's attributes and a 'make/view reservation' button as well. The link found in the title of each film redirects the user to the ```film.html``` template. The ```index.html``` HTML template view is rendered when the user clicks on the 'Now playing' or 'Theater' button of the navbar.

## theater/templates/theater/layout.html
This HTML template is the base of all of the other HTML templates I created. It defines the JavaScript and CSS files that are used for all of the other templates, and it defines the navbar and all of the links that appear on it, as well as the search bar. 

## theater/templates/theater/login.html
This HTML template is rendered when the user clicks on the 'Login' button in the navbar. It provides the user with 'username' and 'password' text inputs and a 'login' button that allows a user to log into the web application.

## theater/templates/theater/new_film.html
This HTML template is rendered when an admin user clicks on the 'New film' button in the navbar. It provides the user with a form in which they can type in the title of the film they wish to create for the theater, and a 'Create' button that submits the form and redirects the user to the ```index.html``` template. 

## theater/templates/theater/register.html
This HTML template is rendered when a user clicks on the 'Register' button in the navbar. It provides the user with a form in which they can type in their desired username, an email and a password, with a 'Register' button at the end that effectively creates their user for the app and redirects them to the 'Now playing' page. Note that this only creates consumer users. In order to create an admin user, one must do it through the use of a Django superuser and creating an admin user using the ```django-admin``` interface. 

## theater/templates/theater/reservation_page.html
This HTML template is rendered when a user clicks on any 'Make reservation' button. It shows a view of the theater, the available/ocuupied/selected seats, and a reserve/cancel button depending on the admin status of the user. Inside this template, a consumer user can select the seats they want to reserve and click on reserve, or an admin user can cancel the reservation of any other user. 

## theater/templates/theater/search_error.html
This HTML template is rendered when an admin user attempts to create a New film, but said film is not found within the API database. The user is presented with a message that suggests trying to create the film using another, more specific film title. 

## theater/templates/theater/search_results.html
This HTML template is rendered when an admin user types something into the search bar and submits their search. It is identical to the ```index.html``` with the difference that the films that are rendered here are only the ones that match what the user was searching for. 

## theater/templates/theater/user_reservations.html
This HTML template is rendered when an admin user clicks on the their username in the navbar. It shows all of that user's currently made reservations, with the film they reserved for, the seats they selected and a button that allows them to cancel that specific reservation. Notice that this view is only available for consumer users. Admin users don't have the ability to access this template. 

## theater/admin.py
In this file, I simply added my models to the admin page so that I could manipulate them using the ```django-admin``` interface with the help of a superuser.

## theater/apps.py
In this file, I simply delcared the name of the only Django app I created, called 'theater'.

## theater/forms.py
In this file I created the only form I needed for my web app, which corresponds to the 'New film' form that an admin user can fill out to create a new film for the theater. 

## theater/models.py
In this file, I created the three models I used for my web application. Each model describes its name, attributes and ```__str__``` and ```serialize``` functions.

## theater/urls.py
In this file, I declared all of the possible URLs that a user can access while using my web application. It is divided into two sections: urls that call functions directly in the back-end, and urls that depend on the external API I used, and urls that depend on the built-in API I built to communicate the back-end with the front-end.

## theater/views.py
In this file, you will find all of the functions that I created that run in the back-end of my web application. This file is the spinal cord of my project.

## db.sqlite3
This is the file that contains the database of my web application. The database that is currently stored in this file is the one that I showed in my 5-minute demo of my app, found [here](https://youtu.be/wYEL4SQRQIs).

## manage.py
This is the Django-autogenerated file that allows the user to run the web application, among other functionalities like making migrations, migrating and running a shell. This is also a very important file for the project. Without it, the web application cannot be run. 

## README.md
The file you're reading right now.

## requirements.txt
This file contains the Python packages that need to be installed in order to run my web application.

**All of the other files that were not mentioned in this section were autogenerated by Django and I did not modify them.**

# How to run my application
My web application relies on an external API to work completely. This external API is provided at [this](https://rapidapi.com/rapidapi/api/movie-database-imdb-alternative/) link. I subscribed to this API to get acces to its API key and to be able to make calls to it. This API key is hardcoded into the ```views.py``` file inside a function called ```get_movie```, so it should work just fine.  

However, if for some reason this API key does not work, you can create your own account [here](https://rapidapi.com/auth/sign-up?referral=/marketplace). After you've done that, you can search for the API I used using the search bar and typing 'Movie Database (IMDB alternative)'. The first link that appears is the one I used. Click on it and you'll be redirected to the main page of the API. In the upper right corner you'll find a 'Subscribe' button, which redirects you to choosing a subscription plan. You can pick the free one, which is the one that I used. After you've subscribed, you can click on 'Manage subscription' under the 'Subscribed' button (it replaces the 'Subscribe' button once you have subscribed) and you'll be taken to the management page. In the left part of the page you'll find a sidebar, in which one button says 'My apps'. You'll see one application name: click it, and select 'Security'. You'll see the API key that was provided to you. Click on the crossed eye to see it and copy it to your clipboard. 

Now, inside of the ```get_movie``` function inside of ```views.py```, replace my key with the one you just copied in the part of the code that says:

```
headers = {
            'x-rapidapi-key': "YOUR_API_KEY_HERE", # This is the API key that was provided to me when I subscribed to this API.
            'x-rapidapi-host': "movie-database-imdb-alternative.p.rapidapi.com"
          }
``` 
Please keep in mind that this previous code snippet appears twice inside the ```get_movie``` function, so please be sure to replace the key in both instances of the snippet provided above. 

By following these steps, the web application will work properly. 

**IMPORTANT NOTE: YOU ONLY HAVE TO FOLLOW THE PREVIOUS STEPS IF THE WEB APPLICATION DOES NOT WORK WITH THE API KEY THAT IS ALREADY HARDCODED INTO ````views.py````. IF IT WORKS JUST FINE WITH MY KEY, DO NOT FOLLOW THE AFOREMENTIONED STEPS**.

Finally, to run my web application, you must simply run ```python manage.py runserver``` on your command prompt/terminal while standing on the main directory of my project and the web-app will start locally. Go to the provided address on your browser and you're good to go. 

# Distinctiveness and Complexity
I believe this project satisfies the distinctiveness and complexity requirements mentioned in the project guidelines because of the following reasons:
- It utilizes Django in the back-end with at least one model.
- It utilizes JavaScript in the front-end.
- It is mobile-responsive (uses bootstrap).
- It is complex in the sense that it utilizes JavaScript fetch calls to an API I built myself (visible in the API routes inside ```theater/urls.py```) in order to make changes to the database without needing a full page reload, it also makes fetch calls to another exeternal API to get information about films, it utilizes CSS animations and transformations to give a more aesthetic and pleasant look and user experience, and it implements functions that allow for making reservations, cancelling reservations, searching from a searchbar, filtering results by query and pagination.
 

# Additional information
My web application is connected to an external API (found [here](https://rapidapi.com/auth/sign-up?referral=/marketplace)), whose description was already provided in the *How to run my application* section of this README). The API key is hardcoded into the ```views.py``` file found at ```https://github.com/me50/jpnaranjo20/blob/web50/projects/2020/x/capstone/theater/views.py```.

To create the view found at ```theater/templates/theater/reservation_page.html```, I guided myself using the HTML, CSS and JavaScript code found [here](https://code-projects.org/movie-seat-booking-in-javascript-with-source-code/). This code served ***only*** as a base for the code that you will find in this repository. Although it is similar, you'll see that it is not exactly the same and was used only as a guide to implement the functions I wanted for my web application.
